<div class="container">
  <div class="header-section">
    <h1>Laptop Inventory</h1>
    <%= link_to "Add New Laptop", new_laptop_path, class: "btn" %>
  </div>

  <!-- Search and Filter Form -->
  <div class="filters">
    <%= form_with url: laptops_path, method: :get, local: true, class: "filter-form" do |f| %>
      <div class="filter-group">
        <%= f.text_field :search, placeholder: "Search by brand, model, SKU, or serial...", value: params[:search], class: "form-control" %>
        
        <%= f.select :brand, 
                     options_for_select([["All Brands", ""]] + @brands.map { |b| [b, b] }, params[:brand]),
                     {}, 
                     class: "form-control" %>
        
        <%= f.select :status,
                     options_for_select([["All Statuses", ""]] + Laptop.statuses.keys.map { |s| [s.humanize, s] }, params[:status]),
                     {},
                     class: "form-control" %>
        
        <%= f.submit "Filter", class: "btn" %>
        <%= link_to "Clear", laptops_path, class: "btn" %>
      </div>
    <% end %>
  </div>

  <!-- Laptop Cards Grid -->
  <div class="laptops-grid" id="laptop_notifications">
    <% if @laptops.any? %>
      <% @laptops.each do |laptop| %>
        <div class="laptop-card">
          <div class="laptop-image">
            <% if laptop.images.attached? && laptop.main_image %>
              <%= image_tag laptop.main_image.variant(resize_to_limit: [300, 200]), alt: laptop.display_name %>
            <% else %>
              <div class="no-image">No Image</div>
            <% end %>
          </div>
          
          <div class="laptop-info">
            <h3><%= link_to laptop.display_name, laptop_path(laptop) %></h3>
            
            <div class="specs-summary">
              <p><strong>SKU:</strong> <%= laptop.sku %></p>
              <p><strong>Brand:</strong> <%= laptop.brand %></p>
              <p><strong>CPU:</strong> <%= laptop.cpu %></p>
              <p><strong>RAM:</strong> <%= laptop.ram_size %></p>
              <p><strong>Storage:</strong> <%= laptop.storage_capacity %> <%= laptop.storage_type %></p>
            </div>
            
            <div class="laptop-status">
              <span class="badge badge-<%= laptop.status %>"><%= laptop.status.humanize %></span>
              <span class="badge badge-<%= laptop.condition %>"><%= laptop.condition.humanize %></span>
            </div>
            
            <% if laptop.purchase_price %>
              <p class="price">Purchase Price: <%= format_currency(laptop.purchase_price) %></p>
            <% end %>
            
            <div class="actions">
              <%= link_to "View", laptop_path(laptop), class: "btn btn-sm" %>
              <%= link_to "Edit", edit_laptop_path(laptop), class: "btn btn-sm" %>
              <% if current_user.admin? %>
                <%= button_to "Delete", laptop_path(laptop), method: :delete, 
                              data: { turbo_confirm: "Are you sure?" }, 
                              class: "btn btn-sm" %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="no-results">
        <p>No laptops found. <%= link_to "Add your first laptop", new_laptop_path %></p>
      </div>
    <% end %>
  </div>
</div>

<style>
.container { max-width: 1200px; margin: 0 auto; padding: 20px; }
.header-section { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
.filters { background: var(--card); padding: 16px; border-radius: 10px; border: 1px solid var(--border); margin-bottom: 24px; }
.filter-form { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
.filter-group { display: flex; gap: 10px; flex: 1; }
.form-control { padding: 9px 12px; border: 1px solid var(--border); border-radius: 8px; font-size: 14px; }
.form-control:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(45,138,117,0.15); }
.laptops-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 18px; }
.laptop-card { background: var(--card); border: 1px solid var(--border); border-radius: 10px; overflow: hidden; box-shadow: 0 3px 10px rgba(15,23,42,0.06); display: flex; flex-direction: column; }
.laptop-image { height: 200px; overflow: hidden; background: #f4f4f5; display: flex; align-items: center; justify-content: center; }
.laptop-image img { width: 100%; height: 100%; object-fit: cover; }
.no-image { color: #9ca3af; font-size: 14px; }
.laptop-info { padding: 14px; display: flex; flex-direction: column; gap: 8px; flex: 1; }
.laptop-info h3 { margin: 0; font-size: 17px; }
.laptop-info h3 a { color: var(--text); text-decoration: none; }
.laptop-info h3 a:hover { color: var(--accent); }
.specs-summary p { margin: 3px 0; font-size: 13px; color: #374151; }
.laptop-status { display: flex; gap: 6px; flex-wrap: wrap; }
.badge { display: inline-flex; align-items: center; padding: 5px 9px; border-radius: 999px; font-size: 12px; font-weight: 600; background: rgba(45,138,117,0.10); color: var(--accent); border: 1px solid rgba(45,138,117,0.25); }
.price { font-weight: 700; color: var(--text); margin: 6px 0; font-size: 14px; }
.actions { display: flex; gap: 6px; margin-top: auto; }
.no-results { text-align: center; padding: 32px; background: var(--card); border: 1px solid var(--border); border-radius: 10px; }
</style>
