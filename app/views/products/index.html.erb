<div class="container">
  <div class="header-section">
    <h1>Inventory</h1>
    <%= link_to "Add New Product", new_product_path, class: "btn btn-primary" %>
  </div>

  <div class="filters">
    <%= form_with url: products_path, method: :get, local: true, class: "filter-form" do |f| %>
      <div class="filter-group">
        <%= f.text_field :search, placeholder: "Search by name, SKU, serial, brand, model...", value: params[:search], class: "form-control" %>
        <%= f.select :category,
                     options_for_select([["All Categories", ""]] + Product.categories.keys.map { |c| [c.humanize, c] }, params[:category]),
                     {},
                     class: "form-control" %>
        <%= f.select :status,
                     options_for_select([["All Statuses", ""]] + Product.statuses.keys.map { |s| [s.humanize, s] }, params[:status]),
                     {},
                     class: "form-control" %>
        <%= f.submit "Filter", class: "btn btn-secondary" %>
        <%= link_to "Clear", products_path, class: "btn btn-outline" %>
      </div>
    <% end %>
  </div>

  <div class="products-grid" id="product_notifications">
    <% if @products.any? %>
      <% @products.each do |product| %>
        <div class="product-card">
          <div class="product-image">
            <% if product.images.attached? %>
              <%= image_tag product.images.first.variant(resize_to_limit: [300, 200]), alt: product.display_name %>
            <% else %>
              <div class="no-image">No Image</div>
            <% end %>
          </div>

          <div class="product-info">
            <h3><%= link_to product.display_name, product_path(product) %></h3>
            <div class="specs-summary">
              <p><strong>SKU:</strong> <%= product.sku %></p>
              <p><strong>Category:</strong> <%= product.category.humanize %></p>
              <p><strong>Brand:</strong> <%= product.brand %></p>
              <p><strong>Model:</strong> <%= product.model %></p>
            </div>

            <div class="product-status">
              <span class="badge badge-<%= product.status %>"><%= product.status.humanize %></span>
              <span class="badge badge-<%= product.condition %>"><%= product.condition.humanize %></span>
            </div>

            <% if product.purchase_price %>
              <p class="price">Purchase Price: $<%= number_with_precision(product.purchase_price, precision: 2) %></p>
            <% end %>

            <div class="actions">
              <%= link_to "View", product_path(product), class: "btn btn-sm btn-info" %>
              <%= link_to "Edit", edit_product_path(product), class: "btn btn-sm btn-warning" %>
              <% if current_user.admin? %>
                <%= button_to "Delete", product_path(product), method: :delete,
                              data: { turbo_confirm: "Are you sure?" },
                              class: "btn btn-sm btn-danger" %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="no-results">
        <p>No products found. <%= link_to "Add your first product", new_product_path %></p>
      </div>
    <% end %>
  </div>
</div>

<style>
.container { max-width: 1200px; margin: 0 auto; padding: 20px; }
.header-section { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
.filters { background: #f5f5f5; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
.filter-form { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
.filter-group { display: flex; gap: 10px; flex: 1; }
.form-control { padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; }
.products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
.product-card { background: white; border: 1px solid #ddd; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.product-image { height: 200px; overflow: hidden; background: #f0f0f0; display: flex; align-items: center; justify-content: center; }
.product-image img { width: 100%; height: 100%; object-fit: cover; }
.no-image { color: #999; font-size: 14px; }
.product-info { padding: 15px; }
.product-info h3 { margin: 0 0 10px 0; font-size: 18px; }
.product-info h3 a { color: #333; text-decoration: none; }
.product-info h3 a:hover { color: #007bff; }
.specs-summary p { margin: 5px 0; font-size: 14px; }
.product-status { margin: 10px 0; }
.badge { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 12px; margin-right: 5px; }
.badge-available { background: #28a745; color: white; }
.badge-allocated { background: #17a2b8; color: white; }
.badge-in_service { background: #ffc107; color: black; }
.badge-retired { background: #dc3545; color: white; }
.badge-sold { background: #6c757d; color: white; }
.badge-new_condition { background: #17a2b8; color: white; }
.badge-used { background: #6c757d; color: white; }
.badge-refurbished { background: #007bff; color: white; }
.price { font-weight: bold; color: #28a745; margin: 10px 0; }
.actions { display: flex; gap: 5px; margin-top: 10px; }
.btn { padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; text-decoration: none; display: inline-block; font-size: 14px; }
.btn-primary { background: #007bff; color: white; }
.btn-secondary { background: #6c757d; color: white; }
.btn-info { background: #17a2b8; color: white; }
.btn-warning { background: #ffc107; color: black; }
.btn-danger { background: #dc3545; color: white; }
.btn-outline { background: white; color: #6c757d; border: 1px solid #6c757d; }
.btn-sm { padding: 5px 10px; font-size: 12px; }
.no-results { text-align: center; padding: 40px; background: #f5f5f5; border-radius: 8px; }
</style>
