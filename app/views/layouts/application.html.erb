<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Ditronics Inventory" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Inventory">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body>
    <% if user_signed_in? %>
      <nav class="main-nav">
        <div class="nav-container">
          <div class="nav-brand">
            <%= link_to "ðŸ–¥ï¸ Ditronics Inventory", root_path %>
          </div>
          
          <ul class="nav-links">
            <li><%= link_to "Dashboard", root_path, class: current_page?(root_path) ? "active" : "" %></li>
            <li><%= link_to "Laptops", laptops_path, class: current_page?(laptops_path) ? "active" : "" %></li>
            <li><%= link_to "Sales", sales_path, class: current_page?(sales_path) ? "active" : "" %></li>
            <% if current_user.admin? %>
              <li class="admin-badge">Admin</li>
            <% else %>
              <li class="employee-badge">Employee</li>
            <% end %>
          </ul>
          
          <div class="nav-user">
            <span class="user-email"><%= current_user.name || current_user.email %></span>
            <%= button_to "Sign Out", logout_path, method: :delete, class: "btn-signout" %>
          </div>
        </div>
      </nav>
    <% end %>

    <% if notice.present? %>
      <div class="flash-notice"><%= notice %></div>
    <% end %>
    
    <% if alert.present? %>
      <div class="flash-alert"><%= alert %></div>
    <% end %>

    <%= yield %>

    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background: #f8f9fa; }
      
      .main-nav { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
      .nav-container { max-width: 1400px; margin: 0 auto; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; height: 60px; }
      .nav-brand a { color: white; text-decoration: none; font-size: 20px; font-weight: bold; }
      .nav-links { display: flex; list-style: none; gap: 25px; align-items: center; }
      .nav-links li a { color: white; text-decoration: none; padding: 5px 10px; border-radius: 4px; transition: background 0.3s; }
      .nav-links li a:hover { background: rgba(255,255,255,0.2); }
      .nav-links li a.active { background: rgba(255,255,255,0.3); font-weight: 600; }
      .admin-badge { background: #ffc107; color: #000; padding: 4px 12px; border-radius: 4px; font-size: 12px; font-weight: 600; }
      .employee-badge { background: #28a745; color: white; padding: 4px 12px; border-radius: 4px; font-size: 12px; font-weight: 600; }
      .nav-user { display: flex; align-items: center; gap: 15px; }
      .user-email { font-size: 14px; }
      .btn-signout { background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 6px 15px; border-radius: 4px; cursor: pointer; font-size: 14px; }
      .btn-signout:hover { background: rgba(255,255,255,0.3); }
      
      .flash-notice { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; padding: 15px 20px; margin: 20px auto; max-width: 1400px; border-radius: 4px; }
      .flash-alert { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; padding: 15px 20px; margin: 20px auto; max-width: 1400px; border-radius: 4px; }
    </style>
  </body>
</html>
